---
title: "vue flow"
description: 
date: 2025-04-07 10:00:00 +0800
categories: [WEB]
tags: [WEB]
pin: false

media_subpath: ""
#
# image:
#   path: 'assets/**/**.jpg'
#   alt: Here is the text upder the image
---

## 安装
```sh
npm add @vue-flow/core
```
```css
To ensure Vue Flow's is correctly displayed, make sure you include the necessary styles.

/* these are necessary styles for vue flow */
@import '@vue-flow/core/dist/style.css';

/* this contains the default theme, these are optional styles */
@import '@vue-flow/core/dist/theme-default.css';
```

工具：
`npm install @vue-flow/background`
```js
import { Background } from '@vue-flow/background'

<template>
  <VueFlow>
    <Background />
  </VueFlow>
</template>

```
`npm install @vue-flow/minimap`
```js
import { VueFlow } from '@vue-flow/core'
import { MiniMap } from '@vue-flow/minimap'

// import default minimap styles
import '@vue-flow/minimap/dist/style.css'

<template>
  <VueFlow>
    <MiniMap />
  </VueFlow>
</template>
```
`npm install @vue-flow/controls`
```html
<script setup>
import { VueFlow } from '@vue-flow/core'
import { Controls } from '@vue-flow/controls'

// import default controls styles
import '@vue-flow/controls/dist/style.css'
</script>

<template>
  <VueFlow>
    <Controls />
  </VueFlow>
</template>
```

## node
```html
<script setup lang="ts">
import type { NodeProps } from '@vue-flow/core'  
import { Position } from '@vue-flow/core'

import { CustomData, CustomEvents } from './nodes'

// props were passed from the slot using `v-bind="customNodeProps"`
const props = defineProps<NodeProps<CustomData, CustomEvents>>()
  
console.log(props.data.hello) // 'world'
</script>

<template>
  <div>
    <Handle type="target" :position="Position.Top" />
    <div>{{ label }}</div>
    <Handle type="source" :position="Position.Bottom" />
  </div>
</template>
```

```html
<script setup lang="ts">
import { ref } from 'vue'
import type { Node } from '@vue-flow/core'
import { VueFlow } from '@vue-flow/core'

import CustomNode from './CustomNode.vue'
import SpecialNode from './SpecialNode.vue'

// You can pass 3 optional generic arguments to the Node interface, allowing you to define:
// 1. The data object type
// 2. The events object type
// 3. The possible node types

export interface CustomData {
  hello: string
}

export interface CustomEvents {
  onCustomEvent: (event: MouseEvent) => void
}

type CustomNodeTypes = 'custom' | 'special'

type CustomNode = Node<CustomData, CustomEvents, CustomNodeTypes>

export const nodes = ref<CustomNode[]>([
  {
    id: '1',
    data: { label: 'Node 1' },
    // this will create the node-type `custom`
    type: 'custom',
    position: { x: 50, y: 50 },
  },
  {
    id: '2',
    data: { label: 'Node 2' },
    // this will create the node-type `special`
    type: 'special',
    position: { x: 150, y: 50 },
  },
    
  {
    id: '3', 
    data: { label: 'Node 3' },
    // this will throw a type error, as the type is not defined in the CustomEdgeTypes
    // regardless it would be rendered as a default edge type
    type: 'invalid',
    position: { x: 150, y: 50 },
  }
])
</script>

<template>
  <VueFlow :nodes="nodes">
    <template #node-custom="customNodeProps">
      <CustomNode v-bind="customNodeProps" />
    </template>
    
    <template #node-special="specialNodeProps">
      <SpecialNode v-bind="specialNodeProps" />
    </template>
  </VueFlow>
</template>
```


或者，也可以通过将对象作为 prop 传递给 VueFlow 组件（或作为可组合项的选项）来定义节点类型。
```html
<script setup>
import { markRaw } from 'vue'
import CustomNode from './CustomNode.vue'
import SpecialNode from './SpecialNode.vue'

const nodeTypes = {
  custom: markRaw(CustomNode),
  special: markRaw(SpecialNode),
}

const nodes = ref([
  {
    id: '1',
    data: { label: 'Node 1' },
    type: 'custom',
  },
  {
    id: '1',
    data: { label: 'Node 1' },
    type: 'special',
  }
])
</script>

<template>
  <VueFlow :nodes="nodes" :nodeTypes="nodeTypes" />
</template>
```

Vue Flow 提供了两种监听节点事件的主要方法，一种是使用 useVueFlow 将监听器绑定到事件处理程序，另一种是将它们绑定到 `<VueFlow>` 组件。

防止节点的拖曳行为
```html
<script setup>
import { ref } from 'vue'

const inputValue = ref('')
</script>

<template>
  <div class="custom-node-container">
    <input class="nodrag" v-model="inputValue" />
  </div>
</template>
```

## edge
Each edge runs from one handle to another, and can be customized to your liking.

Vue Flow 提供了几种内置edge type，您可以立即加以利用。包含的节点类型有default (bezier), step, smoothstep and straight。

可以通过将一个object（edgeTypes）作为prop传递给 VueFlow 组件（或作为可组合的选项）来定义边缘类型。
```html
<script setup>
import { markRaw } from 'vue'
import CustomEdge from './CustomEdge.vue'

const edgeTypes = {
  custom: markRaw(CustomEdge),
}

const nodes = ref([
  {
    id: '1',
    position: { x: 50, y: 50 },
    data: { label: 'Node 1', },
  },
  {
    id: '2',
    position: { x: 50, y: 250 },
    data: { label: 'Node 2', },
  },
])

const edges = ref([
  {
    id: 'e1->2',
    type: 'custom',
    source: '1',
    target: '2',
  },
])
</script>
<template>
  <VueFlow :nodes="nodes" :edges="edges" :edgeTypes="edgeTypes" />
</template>
```

## Handles
句柄是通常位于节点边界上的小圆圈。它们用于将节点连接在一起，方法是将连接线从一个句柄拖到另一个句柄，从而在节点之间建立连接（边缘）。

句柄是 VueFlow 的重要组成部分，因为它们是用户在节点间创建边的主要交互点。

如果没有句柄，基本上就无法在节点之间创建边，因为句柄用于计算边的源点和目标点。

`<Handle>`组件可以在（自定义）node组件中使用，为节点创建句柄。在节点组件上下文之外使用`<Handle>`组件不会像预期的那样工作，所以要尽量避免这种情况。

```html
<script setup>
import { Handle } from '@vue-flow/core'
  
defineProps(['id', 'sourcePosition', 'targetPosition', 'data'])
</script>

<template>
  <Handle type="source" :position="sourcePosition" />
  
  <span>{{ data.label }}</span>
  
  <Handle type="target" :position="targetPosition" />
</template>
```

在某些情况下，您可能根本不想显示句柄。你可以通过设置不透明度：0作为句柄的样式来隐藏句柄。您不能通过从DOM中删除句柄来隐藏它（例如使用v-if或v-show），因为这会破坏对边缘的计算。
```html
<Handle type="source" :position="Position.Right" style="opacity: 0" />
```
